# Colors

## Regions

This project contains a website with multiple regions, each region can have it's own pages and content. Each region has it's own cms instance (read more about this in [migrations](#migrations)).

## Migrations

Migrations are a way to make changes to the cms reproducible. We use this to ensure the cms instance of every region cms has the same models and blocks.

This project uses scripts to trigger migrations, this has the benefit of custom errors and safeguards making it easier and safer to work with migrations. These scripts are located in the `datocms/scripts` folder and can be triggered using the npm scripts in `package.json`.

It is recommended to use the generated migration name (generated by `npm run datocms:create-migration`) as migration names need to be both unique and sortable chronologically which the generated migration names are by default. This is necessary to ensure the migrations are applied in the correct order.

### Usage

**Creating a new environment**

To create a new (sandbox) environment, run the following command:

```sh
$ npm run datocms:create-env "ENVIRONMENT_NAME"
```

**Creating a new migration**

To create a new migration, run the following command:

```sh
$ npm run datocms:create-migration "MIGRATION_NAME" "ENVIRONMENT_NAME"
```

This will create a new migration file in the migrations directory as specified in the `datocms.config.json`, otherwise it defaults to `./migrations`.

**Promoting an environment**

When you have 'pending migrations'* locally on your machine, you can promote these migrations to be part of the new primary environment by running the following command:

```sh
$ npm run datocms:promote-env
```

* _pending migrations = migrations you've generated on a datocms environment, but have not been applied to the primary datocms environment._

### Workflow

// todo use examples to illustrate the workflow this project offers users (also describe the steps between the npm scripts they need to run [e.g. making changes, testing and confirming everything still works]).

// todo: list all required constants/env vars + the expected structure of the datocms instance (currently: a schema_migration model is needed for example)
